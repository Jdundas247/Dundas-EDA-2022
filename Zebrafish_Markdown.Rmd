---
title: "Zebrafish EDA Project"
output: github_document
---

Effects of Chemical Alarm Cue on Zebrafish Embryonic and Early Life Development

Abstract

> Zebrafish are able to sense alarm cue, chemicals released when another fish is attacked by a predator, in order to alert themselves of potential danger. Because of this, their behavior changes as an increase in overall activity as they try and avoid any potential predators nearby. A similar thing happens with zebrafish eggs, in that they can also sense alarm cue or mechanical disturbances nearby and will then hatch early as a response. While hatching early allows the hatchling to relocate and potentially avoid predators, it comes with the tradeoff of being underdeveloped compared to those who hatch at a normal time. Using both body measurements and swimming tests, we can determine whether each hatchling is underdeveloped. To compare the data, the hatchlings are sorted by both hatch time and cue type (alarm vs water). We can then compare body measurements (yolk height, body length, fin lengths, eye dimensions) and swimming ability (average and max swimming velocity.) This then allows us to show how chemical alarm cues effect embryonic development in zebrafish

Methods

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse, ggplot)
library(readxl)
```

> Renaming the data to fit code better.

```{r rename, echo=FALSE}
my_data <- read_excel("ZebrafishQuantData_test.xlsx")

zf_data<-rename(my_data, total_length = TL, 
    yolk_height = YolkHt, tail_length = "Lttailfromtipmsc(mm)", body_cavity_lenth = BodyCavLen, trunk_total =   TrunkTotal,head_depth = HeadDpth, caudal_fin_height = CaudHt, trunk_and_fin = "Trunk+Fin", dorsal_fin_height = DorsalFin, dorsal_fin_length = DorsalFinLen, anal_fin_length = AnalFinLen, eye_height = EyeHt, eye_length = EyeLen, hatch_time_hours = "hatchtime(hours)", average_velocity = VelAvg, max_velocity = VelMax, cue_type = W1A2)
```

> The data is grouped by cue type to view how effective alarm cue was on development.

```{r group}
zf_group<-group_by(zf_data, cue_type)
```

> Calculating T-Score for error bars.

```{r tscore}
alpha = 0.05
degrees.freedom = length(zf_data) - 1
t.score = qt(p=alpha/2, df=degrees.freedom,lower.tail=F)
print(t.score)
```

> Summary for Yolk Height which will be used for figure 1.

```{r yolk}
zf_summary_yolk <-
  summarize(
    zf_group, 
    mean_yolk = mean(yolk_height),
    sem_yolk = sd(yolk_height) / sqrt(n()),
    ci_upper_limit = mean_yolk + t.score * sem_yolk,
    ci_lower_limit = mean_yolk - t.score * sem_yolk)
```

> Figure 1: Yolk height comparisons between cue types. Less developed fish will have larger yolks.

```{r yolk graph, echo=FALSE}
ggplot(data = zf_data) +
  geom_jitter(mapping = aes(x = cue_type, 
                            y = yolk_height, color = hatch_time_hours), width = 0.3)+
  geom_point(
    data = zf_summary_yolk, 
    mapping = aes(x = cue_type, y = mean_yolk, 
                  ymax = ci_upper_limit, 
                  ymin = ci_lower_limit),
    color = "red", size=3)+
  scale_color_gradient(low = "blue", high = "green")+
  geom_linerange(
    data = zf_summary_yolk, 
    mapping = aes(x = cue_type, y = mean_yolk, 
                  ymax = ci_upper_limit, 
                  ymin = ci_lower_limit),
    color = "red", size=1)
```

> Figure 2: Comparison of hatch times between each cue type

```{r hatch}
ggplot(data = zf_data) +
  geom_histogram(mapping = aes(x = hatch_time_hours), 
                 binwidth = 6)+
  facet_wrap(~ cue_type, scales = "free_y")
```

> Figure 3: Comparison of maximum velocities between cue types. Methods are the same as Figure 1.

```{r Velocity}
zf_summary_vmax <-
  summarize(
    zf_group, 
    mean_vmax = mean(max_velocity),
    sem_vmax = sd(max_velocity) / sqrt(n()),
    ci_upper_limit = mean_vmax + t.score * sem_vmax,
    ci_lower_limit = mean_vmax - t.score * sem_vmax)

ggplot(data = zf_data) +
  geom_jitter(mapping = aes(x = cue_type, y = max_velocity, color = hatch_time_hours),
              width = 0.3, size=2)+
  geom_point(
    data = zf_summary_vmax, 
    mapping = aes(x = cue_type, y = mean_vmax, 
                  ymax = ci_upper_limit, 
                  ymin = ci_lower_limit),
    color = "red", size=3)+
  scale_color_gradient(low = "blue", high = "green")+
  geom_linerange(
    data = zf_summary_vmax, 
    mapping = aes(x = cue_type, y = mean_vmax, 
                  ymax = ci_upper_limit, 
                  ymin = ci_lower_limit),
    color = "red", size=1)
```
